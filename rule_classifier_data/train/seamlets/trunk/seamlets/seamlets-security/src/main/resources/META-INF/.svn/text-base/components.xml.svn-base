<?xml version="1.0" encoding="UTF-8"?>
<components xmlns="http://jboss.com/products/seam/components"
	xmlns:drools="http://jboss.com/products/seam/drools" 
	xmlns:persistence="http://jboss.com/products/seam/persistence"
	xmlns:security="http://jboss.com/products/seam/security"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://jboss.com/products/seam/drools http://jboss.com/products/seam/drools-2.1.xsd
				http://jboss.com/products/seam/persistence http://jboss.com/products/seam/persistence-2.1.xsd
				http://jboss.com/products/seam/security http://jboss.com/products/seam/security-2.1.xsd">

	<persistence:managed-persistence-context
		name="securityEntityManager" auto-create="true" persistence-unit-jndi-name="java:/seamletsSecurityEntityManagerFactory" />
		
	<security:identity-manager identity-store="#{jpaIdentityStore}" />
	<security:jpa-identity-store name="jpaIdentityStore"
		entity-manager="#{securityEntityManager}"
		user-class="org.seamlets.identity.User"
		role-class="org.seamlets.identity.Role" />

	<!--
		<security:persistent-permission-resolver>
		permission-store="#{jpaPermissionStore}" />
		<security:jpa-permission-store name="jpaPermissionStore"
		entity-manager="#{securityEntityManager}" user-permission-class="org.seamlets.identity.Permission" />
	-->

	<security:rule-based-permission-resolver
		security-rules="#{securityRules}" />
	<drools:rule-base name="securityRules">
		<drools:rule-files>
			<value>/META-INF/security.drl</value>
		</drools:rule-files>
	</drools:rule-base>

</components>
